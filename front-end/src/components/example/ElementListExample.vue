<template xmlns:v-on="http://www.w3.org/1999/xhtml">
  <div class="canvas-panel">
    <opengraph focus-canvas-on-select>
      <template>
        <geometry-element
          selectable
          movable
          resizable
          connectable
          :angle="30" :id.sync="id" :x.sync="x" :y="y" :width.sync="width" :height.sync="height">
          <geometry-rect :upper-left="[0,0]" :width="1000" :height="1000"
                         :_style="{stroke: randomColor}"></geometry-rect>
          <geometry-polyline :vertices="[[0,0],[500,200],[1000,0]]" :_style="{stroke: 'blue'}">
          </geometry-polyline>
          <geometry-rect :upper-left="[30,30]" :width="500" :height="200" :_style="{stroke: 'red'}">
          </geometry-rect>
          <sub-elements>
            <geometry-element :sub-width="'50%'" :sub-height="'50%'" :sub-top="'30px'" :sub-left="'-50%'">
              <geometry-rect :_style="{stroke: 'orange'}"></geometry-rect>
            </geometry-element>
          </sub-elements>

          <sub-controller cloneable :image="'task.png'" v-on:clone="onClone">
            <geometry-element :width="150" :height="150">
              <geometry-rect :upper-left="[0,0]" :width="1000" :height="1000" :_style="{stroke: 'red'}"></geometry-rect>
            </geometry-element>
          </sub-controller>

          <sub-controller :image="'wrench.png'" v-on:click="sayHello"></sub-controller>
        </geometry-element>

        <text-element :id="'BBB'" :x="600" :y="300" :width="200" :height="100" :text="'hello'" :angle="45">
        </text-element>

        <ellipse-element
          selectable
          movable
          resizable
          connectable
          v-on:beforeConnectShape="beforeConnectShape"
          :id="'AAA'" :x="500" :y="100" :width="200" :height="100" :label="'hello'"></ellipse-element>

        <!--문제: 스타일이 오브젝트 형식이기 때문에 무조건 새로운 프로퍼티로 인식이 된다.-->
        <group-element :x="400" :y="500" :width="200" :height="100" :label="'hello'" :_style="{stroke:'black'}">
        </group-element>

        <horizontal-lane-element :x="700" :y="300" :width="400" :height="200" :label="'hello'"
                                 :_style="{stroke:'black'}">
        </horizontal-lane-element>

        <edge-element
          selectable
          connectable
          :vertices="[[100,100],[300,300],[400,400]]" :from="'AAA'" :to="'BBB'"
          :label="'hello'"></edge-element>

        <!--포토샵이나, http://picsvg.com/ 에서 이미지를 svg 로 엑스포트 한 후, v-bind 를 통해 원하는대로 svg 내부의 어트리뷰트를 꾸미면 됩니다. -->
        <svg-element
          movable
          selectable
          :x="shoeSize" :y="150" :width="200" :height="200" :label="'hello'" :redraw.sync="redraw">
          <svg version="1.0" xmlns="http://www.w3.org/2000/svg" width="200.000000pt" height="133.000000pt"
               viewBox="0 0 200.000000 133.000000" preserveAspectRatio="xMidYMid meet">
            <g transform="translate(0.000000,133.000000) scale(0.050000,-0.050000)" :fill="randomColor"
               stroke="none">
              <path
                d="M1822 1752 c-12 -14 -15 -58 -8 -101 12 -75 12 -75 38 -28 26 47 26 47 22 -13 -3 -47 3 -59 31 -54 19 3 55 -16 80 -42 56 -58 109 -79 127 -50 9 13 5 17 -9 8 -13 -8 -23 -5 -23 6 0 41 35 39 57 -4 36 -68 2 -164 -58 -164 -30 0 -51 -13 -55 -35 -5 -25 2 -31 26 -22 62 23 10 -99 -74 -176 -61 -56 -77 -83 -67 -114 20 -64 -92 -18 -194 79 -98 94 -97 150 10 382 l71 152 -103 12 c-57 7 -157 17 -223 23 -66 5 -237 23 -380 39 -291 33 -354 37 -574 33 -135 -3 -160 -9 -210 -55 -31 -28 -45 -45 -31 -38 16 8 25 -2 25 -28 0 -115 631 -391 1269 -554 264 -67 273 -73 246 -145 -29 -76 -8 -123 54 -123 56 0 68 -29 20 -47 -79 -31 -762 153 -706 190 18 12 11 15 -23 7 -33 -7 -122 17 -258 70 -114 45 -211 77 -216 73 -5 -5 57 -33 138 -64 80 -30 155 -61 166 -69 11 -8 97 -40 190 -70 94 -31 182 -71 196 -88 14 -17 37 -32 51 -32 14 0 42 -16 62 -36 40 -40 69 -30 34 12 -18 23 4 23 142 0 129 -21 181 -22 239 -4 44 14 104 18 150 9 42 -8 102 -20 134 -26 40 -7 63 -1 76 22 20 37 76 45 76 11 0 -12 13 -17 29 -11 15 6 39 -3 53 -19 20 -24 28 -25 41 -4 14 21 20 21 34 0 9 -14 31 -20 50 -13 19 8 33 4 33 -10 0 -15 16 -19 41 -11 22 7 38 6 35 -3 -4 -10 3 -19 13 -21 11 -1 27 -19 36 -40 11 -25 12 -19 5 19 -12 60 18 76 39 21 8 -21 19 -27 27 -14 18 27 109 26 131 -1 11 -14 19 -13 26 4 15 37 47 31 47 -9 0 -29 4 -29 30 5 25 34 32 35 50 9 18 -27 22 -27 40 0 18 27 22 27 40 0 13 -20 19 -21 20 -5 0 13 19 22 43 20 23 -3 46 6 51 19 6 17 -55 24 -228 25 -130 1 -254 5 -276 8 -22 3 -96 13 -165 22 -69 9 -125 25 -125 35 0 10 -9 13 -21 5 -11 -7 -35 0 -53 14 -18 15 -35 25 -39 22 -19 -14 -68 -2 -58 14 7 10 17 71 23 135 13 131 30 161 66 118 14 -16 38 -25 54 -19 22 9 17 22 -23 60 -28 26 -58 44 -66 39 -8 -5 -14 8 -14 29 0 20 4 33 8 28 5 -5 22 9 37 30 33 47 86 33 86 -23 0 -23 11 -36 25 -31 28 9 30 57 6 140 -8 30 -24 49 -34 43 -11 -7 -10 -22 4 -39 17 -21 13 -26 -19 -24 -29 3 -38 15 -33 44 5 23 9 52 10 65 1 28 72 18 113 -16 15 -12 28 -17 28 -10 0 7 19 3 42 -9 34 -18 39 -18 27 2 -11 18 -7 20 13 7 15 -9 35 -18 43 -18 49 -1 14 -41 -41 -46 l-66 -7 72 -48 c40 -27 80 -49 91 -49 28 0 23 55 -6 67 -20 8 -20 10 0 11 14 1 25 16 25 33 0 17 9 26 19 20 11 -7 14 -25 8 -40 -7 -20 15 -35 72 -51 47 -12 77 -31 70 -42 -7 -12 -28 -15 -45 -8 -18 7 -27 6 -19 -2 7 -7 3 -32 -10 -56 -30 -55 -36 -92 -13 -92 10 0 18 10 18 21 0 12 15 37 34 55 41 42 286 52 286 12 0 -16 36 -24 105 -23 120 1 151 12 112 39 -20 15 -18 17 10 8 20 -7 45 -12 56 -12 11 0 14 -9 8 -19 -15 -24 69 -123 92 -109 9 6 17 24 17 40 0 18 -10 24 -23 16 -14 -9 -18 -5 -9 9 32 51 89 -31 84 -120 -2 -26 11 -58 28 -72 37 -30 -73 -145 -140 -145 -28 0 -36 -10 -27 -35 7 -24 5 -27 -7 -10 -30 42 -206 9 -206 -38 0 -20 9 -37 20 -37 11 0 20 10 20 21 0 13 17 16 43 8 27 -8 37 -6 29 7 -7 12 -4 27 8 34 11 7 20 -2 20 -20 0 -19 9 -27 22 -19 12 8 28 5 35 -5 30 -46 193 20 192 78 0 29 7 49 15 43 120 -74 -153 -235 -585 -346 -503 -129 -911 -111 -1499 68 -214 65 -459 124 -630 151 -295 46 -330 62 -381 169 -66 141 -71 341 -6 276 14 -14 39 -25 55 -25 36 0 -15 38 -99 74 l-51 21 13 -126 c9 -86 33 -161 76 -237 l62 -110 -77 27 c-125 44 -196 87 -240 143 -47 60 -54 90 -18 83 13 -3 27 11 31 30 4 19 -2 35 -14 35 -11 0 -21 -9 -21 -20 0 -55 -38 -10 -50 59 -14 84 1 161 31 161 10 0 13 -14 6 -30 -6 -17 1 -46 16 -64 16 -20 17 -28 3 -20 -13 8 -29 6 -36 -6 -12 -20 12 -27 72 -22 63 6 117 -125 64 -155 -27 -15 -27 -18 2 -29 21 -9 33 -1 34 22 1 20 5 24 11 9 14 -35 47 -31 47 5 0 17 -13 30 -30 30 -16 0 -30 10 -30 21 0 12 9 16 20 9 32 -20 23 43 -10 70 -23 19 -25 32 -8 53 17 20 17 27 -2 27 -19 0 -18 8 3 33 25 31 23 31 -17 6 -52 -32 -83 -13 -47 29 20 25 12 40 -42 89 -53 47 -61 64 -42 87 24 29 22 55 -12 166 -23 77 -34 49 -64 -170 -79 -578 76 -754 721 -820 244 -24 500 -80 740 -160 483 -162 668 -184 1100 -131 351 43 700 137 700 189 0 7 27 24 61 39 196 87 268 250 201 460 -63 200 -63 200 -592 331 -154 38 -303 78 -332 89 -28 11 -113 34 -190 53 -163 39 -247 68 -288 100 -16 13 -83 43 -147 67 -64 24 -169 83 -234 132 -89 68 -121 83 -137 63z m-1003 -347 c1 -14 -6 -25 -14 -25 -23 1 -104 134 -90 148 15 16 103 -88 104 -123z m1428 3 c-6 -15 -19 -23 -29 -17 -10 6 -18 2 -18 -10 0 -11 9 -21 20 -21 12 0 30 -24 42 -54 25 -67 -24 -115 -98 -96 -41 10 -44 7 -25 -28 35 -65 26 -182 -14 -194 -67 -22 -125 -55 -125 -72 0 -9 28 -3 62 15 71 37 139 -12 94 -66 -17 -20 -14 -23 11 -13 20 7 33 2 33 -14 0 -21 5 -21 25 -1 20 21 18 31 -10 52 -38 28 -46 211 -10 211 11 0 14 15 7 33 -12 30 35 85 75 86 10 1 12 -55 6 -124 -7 -69 -15 -170 -18 -225 -4 -86 -10 -100 -45 -96 -97 8 -145 22 -195 55 -52 34 -95 29 -95 -11 0 -11 8 -15 18 -9 9 6 29 -3 42 -19 13 -16 33 -24 43 -18 10 6 33 0 49 -14 25 -21 34 -21 47 0 12 20 18 18 27 -6 7 -18 25 -26 43 -20 17 7 31 2 31 -10 0 -33 -377 28 -417 68 -13 13 20 90 39 90 47 0 124 67 90 79 -27 10 -24 20 20 68 29 30 63 52 76 47 15 -6 26 14 28 51 6 71 60 195 86 195 10 0 18 26 18 57 0 31 5 62 12 68 22 22 66 -8 55 -37z m-759 -200 c18 -7 27 -20 21 -30 -16 -25 -192 -22 -229 4 -22 15 -3 19 74 12 58 -4 100 0 94 9 -12 20 -3 21 40 5z"/>
              <path
                d="M2606 1195 c-8 -14 -16 -38 -16 -55 0 -16 -9 -43 -19 -60 -13 -22 -7 -21 21 4 37 33 43 32 99 -5 32 -21 46 -39 31 -39 -16 0 -23 -6 -16 -12 40 -41 71 12 42 71 -30 59 -68 82 -68 40 0 -14 -14 -13 -41 2 -33 17 -37 28 -18 50 13 16 19 29 13 29 -7 0 -19 -11 -28 -25z"/>
              <path
                d="M3269 939 c-6 -11 -19 -15 -29 -9 -20 12 -15 -121 6 -142 7 -8 14 -5 14 6 0 12 16 20 35 19 22 -2 33 9 30 30 -5 25 5 31 37 22 40 -10 41 -14 11 -35 -40 -30 -42 -50 -5 -50 41 0 69 45 54 87 -17 44 -135 100 -153 72z"/>
              <path
                d="M740 859 c0 -12 -9 -16 -20 -9 -11 7 -20 3 -20 -9 0 -11 10 -21 21 -21 12 0 16 -9 9 -20 -7 -11 1 -14 19 -8 17 7 31 21 31 31 0 11 9 14 20 7 11 -7 14 1 8 19 -14 35 -68 43 -68 10z"/>
              <path
                d="M1580 638 c0 -12 18 -26 40 -32 36 -10 49 -30 42 -71 -1 -8 12 -15 29 -15 19 0 26 9 17 23 -10 16 -4 20 20 11 20 -8 29 -6 22 6 -7 11 -1 20 13 20 19 0 19 6 2 23 -13 13 -51 22 -84 21 -34 -1 -61 7 -61 17 0 11 -9 19 -20 19 -11 0 -20 -10 -20 -22z"/>
              <path
                d="M1875 567 c-19 -6 -35 -19 -35 -29 0 -30 67 -48 75 -22 11 32 75 30 142 -4 51 -27 55 -26 57 15 1 23 -3 31 -8 17 -6 -17 -18 -19 -33 -7 -29 24 -152 43 -198 30z"/>
            </g>
          </svg>
        </svg-element>
      </template>
    </opengraph>
  </div>
</template>
<script>
  export default {
    props: {
      monitor: Boolean
    },
    data () {
      return {
        shoeSize: 700,
        redraw: false,
        randomColor: '#000',
        testData: false,
        x: 300,
        y: 300,
        width: 200,
        height: 200,
        id: null
      }
    },
    computed: {},
    mounted() {
      var me = this;

      function getRandomColor() {
        var letters = '0123456789ABCDEF';
        var color = '#';
        for (var i = 0; i < 6; i++) {
          color += letters[Math.floor(Math.random() * 16)];
        }
        me.randomColor = color;
        me.redraw = true;
        me.shoeSize = 310;
      }

      //setInterval(getRandomColor, 200);
//      setTimeout(function () {
//        getRandomColor();
//      }, 2000);
    },
    watch: {},
    methods: {
      onClone: function (a, b, c) {
        console.log('onClone', a, b, c);
      },
      beforeConnectShape: function (a, b, c) {
        //console.log(a,b,c);
      },
      sayHello: function (cloneComponent) {
        console.log('sayHello', cloneComponent);
      }
    }
  }
</script>

<style scoped lang="scss" rel="stylesheet/scss">
  .canvas-panel {
    top: 0px;
    bottom: 0px;
    left: 0px;
    right: 0px;
    position: absolute;
    overflow: hidden;
  }
</style>

